<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Account</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { poppins: ['Poppins', 'sans-serif'] },
          colors: {
            brown: '#8b4513',
            brownDark: '#8b3e12',
            pageBg: '#F8E2D0'
          }
        }
      }
    }
  </script>

  <style>
    /* Header States: Scrolled or Mobile Open */
    header.is-scrolled,
    header.is-mobile-open {
      background-color: #642E13 !important;
      background-image: none !important;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    header.is-scrolled {
      height: 80px !important;
    }

    header.is-mobile-open {
      height: auto !important;
    }

    @media (min-width: 768px) {
      header.is-scrolled {
        height: 96px !important;
      }
    }
  </style>
</head>

<body class="font-poppins bg-pageBg text-gray-800">

  <header
    class="bg-[#642E13] md:bg-transparent md:bg-gradient-to-b md:from-[#642E13] md:via-[#642E13]/80 md:to-transparent w-full fixed top-0 z-50 font-poppins transition-all duration-500 md:h-[190px] h-20">
    <div class="max-w-7xl mx-auto px-4 md:px-6 lg:px-8">
      <div class="flex items-center justify-between h-20 md:h-24">

        <!-- Logo -->
        <a href="../Home/Home.html" class="flex-shrink-0">
          <img src="../Assets/Home/Logo-Gajendhra.png"
            onerror="this.src='https://placehold.co/50x50/FDF5ED/5D3420?text=GV'" alt="Gajendra Vilas"
            class="h-10 w-10 md:h-20 md:w-20 rounded-full object-cover border-2 border-white/20">
        </a>

        <nav id="main-nav" class="hidden md:flex items-center gap-1 lg:gap-10 flex-grow justify-center">
          <!-- Menu will be rendered here by MenuRenderer -->
        </nav>

        <!-- Right Icons -->
        <div class="flex items-center gap-3 md:gap-4">
          <!-- Wishlist -->
          <button onclick="openWishlist()" class="text-white hover:opacity-80 transition-opacity p-1 relative">
            <img src="../Assets/images/wishlist.png" alt="Wishlist" class="h-5 w-5 md:h-6 md:w-6">
            <span data-wishlist-badge
              class="absolute -top-1 -right-1 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
          </button>
          <!-- Cart -->
          <button onclick="openCart()" class="text-white hover:opacity-80 transition-opacity p-1 relative">
            <img src="../Assets/images/cart.png" alt="Cart" class="h-5 w-5 md:h-6 md:w-6">
            <span data-cart-badge
              class="absolute -top-1 -right-1 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
          </button>
          <!-- User Dropdown -->
          <div class="relative">
            <button id="user-menu-btn" onclick="toggleUserMenu(event)"
              class="text-white hover:opacity-80 transition-opacity p-1">
              <img src="../Assets/images/profile.png" alt="User" class="h-5 w-5 md:h-6 md:w-6">
            </button>
            <!-- Dropdown Menu -->
            <div id="user-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50">
              <a href="../Auth/login.html"
                class="block px-4 py-2 text-sm text-[#3E1C00] hover:bg-[#FDF5ED] transition-colors">Login</a>
              <a href="../Auth/register.html"
                class="block px-4 py-2 text-sm text-[#3E1C00] hover:bg-[#FDF5ED] transition-colors">Register</a>
              <a href="../Auth/my-account.html"
                class="block px-4 py-2 text-sm text-[#3E1C00] hover:bg-[#FDF5ED] transition-colors">My Account</a>
            </div>
          </div>

          <!-- Mobile Menu Button -->
          <button id="mobile-menu-btn" class="md:hidden text-white p-1" onclick="toggleMobileMenu()">
            <img src="../Assets/Home/icon-menu.png" alt="Menu" class="h-6 w-6">
          </button>
        </div>
      </div>

      <!-- Mobile Navigation -->
      <nav id="mobile-menu" class="md:hidden hidden pb-4">
        <div id="mobile-menu-items" class="flex flex-col gap-3 pt-2 border-t border-white/20">
          <!-- Populated by MenuRenderer -->
        </div>
      </nav>
    </div>
  </header>

  <!-- HERO -->
  <section class="h-[300px] flex items-center justify-center text-center text-white
                bg-[linear-gradient(rgba(0,0,0,0.5),rgba(0,0,0,0.5)),url('Images/login.jpg')]
                bg-cover bg-center">
    <div>
      <h1 class="text-4xl font-semibold mb-2">My Account</h1>
      <p class="uppercase text-sm">Homepage â€º Login</p>
    </div>
  </section>

  <!-- ACCOUNT -->
  <section class="max-w-[1200px] mx-auto my-10 bg-white rounded-2xl shadow-xl
                flex flex-col lg:flex-row overflow-hidden">

    <!-- SIDEBAR -->
    <aside class="lg:w-[280px] w-full border-b lg:border-b-0 lg:border-r border-gray-200 p-6">

      <!-- User Skeleton -->
      <div id="sidebarSkeleton" class="animate-pulse">
        <div class="w-28 h-28 mx-auto bg-gray-200 rounded-full mb-4"></div>
        <div class="h-6 w-32 mx-auto bg-gray-200 rounded mb-2"></div>
        <div class="h-4 w-24 mx-auto bg-gray-200 rounded"></div>
      </div>

      <!-- User Content -->
      <div id="sidebarContent" class="hidden text-center">
        <div class="relative w-28 h-28 mx-auto border-4 border-brown rounded-full group cursor-pointer"
          onclick="document.getElementById('profileImageInput').click()">
          <img id="profileImg" src="https://placehold.co/150x150/FDF5ED/DAA520?text=User"
            class="w-full h-full rounded-full object-cover">
          <span
            class="absolute bottom-0 right-0 bg-brown text-white text-xs px-2 py-1 rounded-md group-hover:bg-brownDark transition">
            <i class="fas fa-camera"></i>
          </span>
          <input type="file" id="profileImageInput" class="hidden" accept="image/*" onchange="uploadProfileImage(this)">
        </div>
        <h3 id="profileName" class="font-semibold mt-4"></h3>
        <p id="profileEmail" class="text-sm text-gray-500"></p>
      </div>

      <ul class="mt-8 space-y-2 text-sm font-medium account-menu">
        <li onclick="openTab('personal', this)"
          class="sidebar-tab cursor-pointer px-4 py-3 rounded-lg bg-brown text-white transition-all duration-200 flex items-center gap-3">
          <i class="fas fa-user w-5"></i> Personal Info
        </li>
        <li onclick="openTab('address', this)"
          class="sidebar-tab cursor-pointer px-4 py-3 rounded-lg text-brown hover:bg-brown/10 hover:text-brownDark transition-all duration-200 flex items-center gap-3">
          <i class="fas fa-map-marker-alt w-5"></i> Address Book
        </li>
        <li onclick="openTab('orders', this)"
          class="sidebar-tab cursor-pointer px-4 py-3 rounded-lg text-brown hover:bg-brown/10 hover:text-brownDark transition-all duration-200 flex items-center gap-3">
          <i class="fas fa-box w-5"></i> My Orders
        </li>
        <li onclick="openTab('wishlist', this)"
          class="sidebar-tab cursor-pointer px-4 py-3 rounded-lg text-brown hover:bg-brown/10 hover:text-brownDark transition-all duration-200 flex items-center gap-3">
          <i class="fas fa-heart w-5"></i> Wishlist
        </li>
        <li onclick="logout()"
          class="cursor-pointer px-4 py-3 rounded-lg text-red-600 hover:bg-red-50 transition-all duration-200 flex items-center gap-3 mt-4 border-t pt-4">
          <i class="fas fa-sign-out-alt w-5"></i> Logout
        </li>
      </ul>
    </aside>

    <!-- CONTENT -->
    <main class="flex-1 p-6 md:p-10">

      <!-- PERSONAL INFO -->
      <div id="personal" class="account-tab block">
        <h2 class="text-xl font-semibold mb-6">Personal Info</h2>

        <!-- Form Skeleton -->
        <div id="personalSkeleton" class="space-y-6 animate-pulse">
          <div class="grid md:grid-cols-2 gap-5">
            <div class="h-12 bg-gray-200 rounded-lg"></div>
            <div class="h-12 bg-gray-200 rounded-lg"></div>
          </div>
          <div class="grid md:grid-cols-2 gap-5">
            <div class="h-12 bg-gray-200 rounded-lg"></div>
            <div class="h-12 bg-gray-200 rounded-lg"></div>
          </div>
          <div class="h-12 w-32 bg-gray-200 rounded-lg"></div>
        </div>

        <form id="personalForm" class="hidden space-y-6">
          <div class="grid md:grid-cols-2 gap-5">
            <div>
              <label class="block text-sm font-medium mb-1">Full Name</label>
              <input name="full_name" type="text"
                class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-brown outline-none">
            </div>

            <div>
              <label class="block text-sm font-medium mb-1">Email</label>
              <input name="email" type="email"
                class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-brown outline-none">
            </div>
          </div>

          <div class="grid md:grid-cols-2 gap-5">
            <div>
              <label class="block text-sm font-medium mb-1">Phone</label>
              <input name="phone" type="tel"
                class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-brown outline-none">
            </div>

            <div>
              <label class="block text-sm font-medium mb-1">Date of Birth</label>
              <input name="dob" type="date"
                class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-brown outline-none">
            </div>
          </div>

          <button class="bg-brownDark text-white px-8 py-3 rounded-lg border
                       hover:bg-white hover:text-brownDark hover:border-brownDark
                       transition shadow-md">
            Save Changes
          </button>
        </form>
      </div>

      <!-- ADDRESS -->
      <div id="address" class="account-tab hidden">
        <h2 class="text-xl font-semibold mb-4">Address Book</h2>

        <button onclick="toggleAddressForm()" class="mb-6 bg-brownDark text-white px-6 py-2 rounded-lg
                     hover:bg-white hover:text-brownDark border transition">
          + Add New Address
        </button>

        <!-- Empty State for Address -->
        <!-- Address List Container -->
        <div id="addressList" class="grid lg:grid-cols-2 gap-4">
          <!-- Skeleton Loader (Default) -->
          <div class="border rounded-xl p-4 space-y-3 animate-pulse">
            <div class="h-4 bg-gray-200 rounded w-1/4"></div>
            <div class="h-4 bg-gray-200 rounded w-3/4"></div>
            <div class="h-4 bg-gray-200 rounded w-1/2"></div>
          </div>
          <div class="border rounded-xl p-4 space-y-3 animate-pulse">
            <div class="h-4 bg-gray-200 rounded w-1/4"></div>
            <div class="h-4 bg-gray-200 rounded w-3/4"></div>
            <div class="h-4 bg-gray-200 rounded w-1/2"></div>
          </div>
        </div>

        <!-- FORM (Hidden) -->
        <form id="addressForm"
          class="hidden bg-white p-6 rounded-xl shadow-md space-y-4 max-w-3xl border border-gray-100 mt-4">
          <h3 class="font-semibold" id="addressFormTitle">Add New Address</h3>
          <input type="hidden" name="address_id" id="address_id">

          <div class="grid md:grid-cols-2 gap-4">
            <input name="full_name" id="addr_name" placeholder="Full Name" class="border px-3 py-2 rounded">
            <input name="phone" id="addr_phone" placeholder="Phone" class="border px-3 py-2 rounded">
          </div>

          <input name="address_line1" id="addr_line1" placeholder="Address Line 1"
            class="border px-3 py-2 rounded w-full">
          <input name="address_line2" id="addr_line2" placeholder="Address Line 2 (Optional)"
            class="border px-3 py-2 rounded w-full">

          <div class="grid md:grid-cols-2 gap-4">
            <input name="city" id="addr_city" placeholder="City" class="border px-3 py-2 rounded">
            <input name="state" id="addr_state" placeholder="State" class="border px-3 py-2 rounded">
          </div>

          <div class="grid md:grid-cols-2 gap-4">
            <input name="pincode" id="addr_pincode" placeholder="Pincode" class="border px-3 py-2 rounded">
            <input name="country" value="India" readonly class="border px-3 py-2 rounded bg-gray-100">
          </div>

          <div class="flex items-center gap-2 mb-2">
            <input type="checkbox" name="is_default" id="addr_default">
            <label for="addr_default" class="text-sm text-gray-600">Make this my default address</label>
          </div>

          <button type="submit" class="bg-brownDark text-white px-6 py-2 rounded-lg border
                       hover:bg-white hover:text-brownDark transition">
            Save Address
          </button>
        </form>
      </div>

      <!-- ORDERS -->
      <div id="orders" class="account-tab hidden">
        <h2 class="text-xl font-semibold mb-4">My Orders</h2>

        <div id="ordersList" class="space-y-4">
          <!-- Skeleton Loader -->
          <div class="border rounded-xl p-5 animate-pulse flex justify-between">
            <div class="space-y-2 w-full">
              <div class="h-4 bg-gray-200 rounded w-1/4"></div>
              <div class="h-4 bg-gray-200 rounded w-1/2"></div>
            </div>
            <div class="h-8 w-20 bg-gray-200 rounded"></div>
          </div>
          <div class="border rounded-xl p-5 animate-pulse flex justify-between">
            <div class="space-y-2 w-full">
              <div class="h-4 bg-gray-200 rounded w-1/4"></div>
              <div class="h-4 bg-gray-200 rounded w-1/2"></div>
            </div>
            <div class="h-8 w-20 bg-gray-200 rounded"></div>
          </div>
        </div>
      </div>

      <!-- WISHLIST -->
      <div id="wishlist" class="account-tab hidden">
        <h2 class="text-xl font-semibold mb-4">My Wishlist</h2>

        <div id="profileWishlistGrid" class="flex flex-wrap gap-6">
          <!-- Skeleton Loader -->
          <div class="w-[220px] rounded-xl p-4 border animate-pulse">
            <div class="h-32 bg-gray-200 rounded-lg mb-3"></div>
            <div class="h-4 bg-gray-200 rounded w-3/4 mb-2"></div>
            <div class="h-4 bg-gray-200 rounded w-1/2"></div>
          </div>
          <div class="w-[220px] rounded-xl p-4 border animate-pulse">
            <div class="h-32 bg-gray-200 rounded-lg mb-3"></div>
            <div class="h-4 bg-gray-200 rounded w-3/4 mb-2"></div>
            <div class="h-4 bg-gray-200 rounded w-1/2"></div>
          </div>
        </div>
      </div>

    </main>
  </section>

  <footer class="w-full bg-white font-poppins pt-0">
    <!-- Content will be injected by HeaderInitializer -->
  </footer>

  <!-- <script src="auth.js"></script> -->
  <script src="../components/popups.js"></script>
  <script type="module" src="../Assets/js/profile.js"></script>
</body>

</html>